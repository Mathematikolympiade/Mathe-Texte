\documentclass[11pt,a4paper]{article}
\usepackage{ngerman,url}
\usepackage{kosemnet,ko-math}

\newcommand{\cas}[1]{\textsc{#1}}

\title{Rekursive Folgen} 
\author{Hans-Gert Gräbe}
\date{17. Oktober 2023}

\begin{document}
\maketitle

Dieser Text lehnt sich an \cite{S} an. Es werden u.a. einige der dort ohne
Lösung angegebenen Aufgaben besprochen.

Bei der Analyse von Folgen ist es oft wichtig, sich einen Überblick über ein
Anfangsstück der Folgenglieder zu verschaffen, um angemessene Hypothesen zu
formulieren oder andere zu verwerfen.  Für derartige Rechnungen kann man
Computer-Algebra-Systeme (CAS) oder andere Pakete zum symbolischen
Rechnen\footnote{Etwa das Python-Paket \emph{SymPy},
\url{https://www.sympy.org/en/index.html} } verwenden, die hinreichend gut
programmierbar sind.  Rechnungen werden im Weiteren mit dem freien CAS
\cas{Maxima}\footnote{\url{https://maxima.sourceforge.io/}} ausgeführt.

\section*{Einleitung}

Eine Folge $(a_n)_{n\ge 1}$ ist nichts anderes als eine Funktion, deren
Definitionsbereich etwa die natürlichen Zahlen sind. Auf diese Weise lassen
sich Folgen auch in einem CAS anschreiben.

Im Gegensatz zu Funktionen über den reellen Zahlen, die in der Regel durch
eine \emph{explizite Bildungsvorschrift} gegeben sind, kann der Bereich der
natürlichen Zahlen schrittweise durchlaufen werden, womit Folgen auch durch
\emph{rekursive Bildungsvorschriften} gegeben werden können. 

Oft schränken rekursive Regeln die Möglichkeiten so weit ein, dass sich eine
überschaubare Menge von Folgen oder auch nur eine einzige ergibt, die allen
Bedingungen genügen. 

\paragraph{Beispiel (MO 591036):}
\begin{quote}
  Für die Folge $(a_n)_{n\ge 1}$ positiver ganzer Zahlen gilt $a_m\le a_n$ und
  $a_m\m a_n=a_{m\m n}$ für alle $m,n$ mit $0<m\le n$ sowie $a_{59}=59$.
  Zeige, dass dann stets $a_n=n$ erfüllt ist.
\end{quote}
\begin{loesung}
  Wäre $a_k=a_{k+1}$ für ein $k$, so wäre $a_k=a_n$ für alle $n\ge k$.
  Anderenfalls gäbe es ein kleinstes $t>k$ mit $a_t>a_k$. Das führt aber zu
  folgendem Widerspruch:
  \begin{gather*}
    a_k^2=a_{t-1}^2=a_{t^2-2t+1}\ge a_{t^2-2t}=a_t\m a_{t-2}=a_t\m a_k
  \end{gather*}
  und damit $a_n\le a_k$.  Die Folge $(a_n)$ ist also streng monoton wachsend.

  Wäre nicht stets $a_n=n$, so gäbe es ein kleinstes $t$ mit $a_t\neq t$.
  Wegen $a_1^2=a_{1\m 1}=a_1>0$ ist $a_1=1$. Wäre $a_2\ge 3$, so wäre 
  \begin{gather*}
    81\le \br{a_2}^4=\br{a_4}^2=a_{16}\le a_{59}=59.
  \end{gather*}
  Also ist $a=a_1<a_2<3$ und damit $a_2=2$.  Ist $t$ gerade, so erhalten wir
  den Widerspruch
  \begin{gather*}
    a_t=a_{t/2}\m a_2=2\m a_{t/2}=2\m \frac{t}{2}=t.
  \end{gather*}
  Ist $t$ ungerade, so erhalten wir die Ungleichung
  \begin{gather*}
    t-1=a_{t-1}<a_t<a_{t+1}=a_{(t+1)/2}\m a_2=2\m a_{(t+1)/2}=2\m
    \frac{t+1}{2}=t+1
  \end{gather*}
  und daraus wieder $a_t=t$ im Widerspruch zur Annahme.   
\end{loesung}

\paragraph{Quelle unbekannt:}
\begin{quote}
  Die Folge $a_1,a_2,\dots$ sei wie folgt definiert: $a_1=1$, $a_{2^k+j}=-a_j$
  für $1\le j\le 2^k$ und $k=0,1,\dots$.

  Man zeige, dass die Folge nicht periodisch ist.
\end{quote}
\begin{loesung}
  Man sieht, dass $a_i=\pm 1$ gilt und die Folge aus je Stücken der Länge
  $2^k$ mit $+1$ oder $-1$ besteht.  Genauer: Es gilt $a_i=(-1)^k$ für alle
  $i$ mit $2^{k-1}<i\le 2^k$. 

  Formaler Beweis: Wäre $p$ eine Periode, also $a_i=a_{i+p}$ für alle $i\ge l$
  dann wähle $m$ so, dass $2^m> p,l$ gilt. Dann ist $a_i=(-1)^m$ für $i=2^m$
  und $a_{i+p}=(-1)^{m+1}=-a_i$, da $2^m<i+p\le 2\m 2^m$. 
\end{loesung}

\paragraph{(MO 530944)}
\begin{quote}
  Gegeben ist $z>0$ und zwei Zahlenfolgen, die durch
  \begin{align*}
    a_1=4z,\ a_{n+1}=\frac{a_n+b_n}{2}\\
    b_1=\frac14z,\ b_{n+1}=\frac{a_n\m b_n}{a_{n+1}}
  \end{align*}
  bestimmt sind. Zeige
  \begin{itemize}
  \item [a)] $a_n+b_n\ge 2z$
  \item [b)] $a_n>a_{n+1}$
  \end{itemize}
\end{quote}
\begin{loesung}
  Es ist $a_{n+1}b_{n+1}=a_nb_n=z^2$ konstant und deshalb
  $b_n=\dfrac{z^2}{a_n}$.  Dann ist aber (a) die bekannte Ungleichung
  $\frac12\br{a_n+\dfrac{z^2}{a_n}}\ge z$ und (b) folgt aus $a_n>b_n$. 
\end{loesung}

\paragraph{\cite{S}, Aufgabe 3}
\begin{quote}
  Auf wie viele Weisen kann ein $(2\times n)$-Rechteck mit Dominosteinen
  ausgelegt werden? 
\end{quote}
\begin{loesung}
  Die Anzahl $a_n$ erfüllt $a_1=1, a_2=2$ und die Rekursion
  $a_n=a_{n-1}+a_{n-2}$ für $n>2$, denn an rechten Ende kann entweder ein
  Dominostein hochkant oder zwei Dominosteine horizontal liegen. 
\end{loesung}

\subsection*{Konvergente Folgen und Grenzwerte}

\paragraph{(MO 271245)}
\begin{quote}
  Gegeben ist die Folge mit $x_1=x_2=1$ und $x_{n+1}=\dfrac{x_n+1}{x_{n-1}+4}$
  für $n>1$.  Untersuchen Sie, ob die Folge konvergiert und bestimmen Sie ggf.
  den Grenzwert.
\end{quote}
Führe hierzu Berechnungen mit \cas{Maxima} durch:
\begin{code}
  x(n):=if n=0 then 1\\
  else if n=1 then 1\\
  else (x(n-1)+1)/(x(n-2)+4);
\end{code}
Diskutiere, warum das für $n>25$ sehr langsam wird.  Verfolge dazu die
Hierarchie der rekursiven Aufrufe.  Ist $a_i$ die Zahl der Aufrufe von
$x(n-i)$ bei der Berechnung von $x(n)$, so ist $a_i=a_{i-1}+a_{i-2}$ mit
$a_0=a_1=1$, denn $x(n-i)$ wird genau bei der Berechnung von $x(n-i+1)$ und
$x(n-i+2)$ aufgerufen.  Die Folge $(a_i)$ (im Wesentlichen die
Fobonacci-Zahlen) wächst exponentiell.

Abhilfe kann das Speichern der Zwischenergebnisse schaffen. 
\begin{code}
  x(n):=if n=0 then A[n]:1\\
  else if n=1 then A[n]:1\\
  else if numberp(A[n]) then A[n]\\
  else A[n]:(x(n-1)+1)/(x(n-2)+4);
\end{code}
Dann wird die Größe der Ergebnisse zum begrenzenden Faktor (ab etwa $n=30$). 

\begin{loesung}
Der Grenzwert, falls er existiert, erfüllt die Gleichung $a=\dfrac{a+1}{a+4}$,
also $a^2+3a-1=0$, woraus $a=-\frac32\pm\frac12\sqrt{13}$ folgt.  Da alle
$x_n>0$, kommt nur $a=\frac12\br{\sqrt{13}-3}$ in Frage.

Für die Existenz des Grenzwerts zeigen wir, dass die Folge $x_n-a$ gegen null
geht, indem wir $\abs{x_n-a}\le c\m \lambda^n$ für ein $c>0$ und $\lambda$ mit
$0<\lambda<1$ zeigen. Dazu der folgende induktive Ansatz (von $n$ und $n+1$
auf $n+2$)
\begin{align*}
  \abs{x_{n+2}-a}&=\abs{\frac{x_{n+1}-a+(a+1)}{x_n+4}-a}\\
  &=\abs{\frac{x_{n+1}-a}{x_n+4}-\br{a-\frac{1+a}{x_n+4}}}\\
  &=\abs{\frac{x_{n+1}-a}{x_n+4}-a\br{\frac{x_n-a}{x_n+4}}},
\end{align*}
wobei in der letzten Umformung $a\br{x_n+4}-a-1=ax_n+3a-1=ax_n-a^2$ eingesetzt
wurde, da $a^2+3a-1=0$ gilt.  Wir erhalten also mit Induktionsvoraussetzung
und $0<a<\frac12$ sowie $x_n>0$
\begin{align*}
  \abs{x_{n+2}-a}&\le
  \abs{\frac{x_{n+1}-a}{x_n+4}}+a\abs{\frac{x_n-a}{x_n+4}}\\
  &<\frac14 c \lambda^{n+1} + \frac18 c \lambda^n = c \lambda^{n+2},
\end{align*}
wenn wir $\lambda=\frac12$ setzen. $c$ passen wir so an, dass der
Induktionsanfang für $n=1$ und $n=2$ passt.  Wegen $x_1=x_2=1$ muss
$\abs{1-a}<c \lambda=\frac12 c$ erfüllt sein. Wegen $3<\sqrt{13}<4$ ist
$0<a<\frac12$ und damit $\abs{1-a}<1$ kann $c=2$ gewählt werden.   
\end{loesung}

\paragraph{Newtonverfahren zum Berechnen der Quadratwurzel}
\begin{gather*}
  x_1=a,\ x_{n+1}=\frac12\br{x_n+\frac{a}{x_n}},\quad n>0
\end{gather*}
Konvergiert gegen $b=\sqrt{a}$, da Grenzwert $b$ der Gleichung
$b=\frac12\br{b+\dfrac{a}{b}}$ genügt. Schnell konvergierendes Verfahren.
Dazu
\begin{gather*}
  \frac{x_{n+1}-b}{x_n-b}=\frac{x_n^2-2bx_n+b^2}{2x_n(x_n-b)}
  =\frac{1}{2x_n}\br{x_n-b}.
\end{gather*}
Also ist $\abs{x_{n+1}-b}<c\m\abs{x_n-b}^2$ mit $c=\dfrac{1}{b}$ für $n\gg 0$,
da wir $2x_n>b$ für große $n$ annehmen können (es ist $x_n\to b$).

\textbf{Aufgabe:} Zeige, dass die Rekursion
$x_{n+1}=\frac12\br{x_n+\dfrac{a}{x_n^{k-1}}}$ mit ähnlichen Eigenschaften
$b=\sqrt[k]{a}$ berechnet. 

\subsection*{Partialsummen und Reihen}

Zur Folge $(a_n)_{n\ge 1}$ kann man die Folge $(s_n)_{n\ge 1}$ der
\emph{Partialsummen} bilden nach der Vorschrift
\begin{gather*}
  s_n=a_1+a_2+\dots+a_n=\sum_{k=1}^n{a_k}.
\end{gather*}
So ist etwa für die Potenzfolge $a_n=q^n, n\ge 1$, $q\ne 1$
\begin{gather*}
  s_n=1+q+q^2+\dots+q^n=\sum_{k=1}^n\br{q^k}
\end{gather*}
Mit Induktion beweist man die explizite Darstellung
$s_n=\dfrac{q^{n+1}-1}{q-1}$, denn es ist
\begin{gather*}
  s_{n+1}=s_n+q^{n+1}\stackrel{IV}{=} \frac{q^{n+1}-1}{q-1}+q^{n+1}
  =\frac{q^{n+2}-q^{n+1}+q^{n+1}-1}{q-1}= \frac{q^{n+2}-1}{q-1}. 
\end{gather*}
Für $\abs{q}<1$ ist diese Folge der Partialsummen konvergent mit dem Grenzwert
$\dfrac{1-q^n}{1-q}\to \dfrac{1}{1-q}$. Diesen Wert bezeichnet man auch als
den Wert der (konvergenten) unendlichen Reihe
\begin{gather*}
  \sum_{k=0}^\infty=1+q+q^2+\dots = \frac{1}{1-q}.
\end{gather*}
\textbf{Aufgabe:}
Man untersuche die Konvergenz der unendlichen Reihe
\begin{gather*}
  s=\frac{1}{1\m 2}+\frac{1}{2\m 3}+\frac{1}{3\m 4}+\dots
\end{gather*}
und ermittle $s$.  

\begin{loesung}
  Es ist $d\frac{1}{n(n+1)}=\dfrac{1}{n}-\dfrac{1}{n+1}$ und somit
  \begin{align*}
    s_n&=\frac{1}{1\m 2}+\frac{1}{2\m 3}+\frac{1}{3\m
      4}+\dots+\frac{1}{n(n+1)} = \br{1-\frac12}+\br{\frac12-\frac13}+\dots
    +\br{\frac{1}{n}-\frac{1}{n+1}}\\ &= 1-\frac{1}{n+1} \to 1.
  \end{align*}
\end{loesung}

\textbf{Aufgabe:} Finde eine ähnliche Formel für
\begin{gather*}
  s=\frac{1}{1\m 2\m 3}+\frac{1}{2\m 3\m }+\frac{1}{3\m 4\m 5}+\dots
\end{gather*}
\begin{loesung}
  Ähnlich wie in \cite{S}, Aufgabe 6, findet man
  \begin{gather*}
    \frac{1}{x(x+1)(x+2)}=\frac{1/2}{x}-\frac{1}{x+1}+\frac{1/2}{x+2}
  \end{gather*}
  und damit $s_n=\frac12\br{1-\frac12-\frac{1}{n+1}+\frac{1}{n+2}}$. 
\end{loesung}

\textbf{Aufgabe:} 
\begin{quote}
  Es sei $(a_n)$ eine unendliche Folge paarweise verschiedener positiver
  natürlicher Zahlen, wobei keines der Folgenglieder in seiner
  Dezimaldarstellung die Ziffer Null enthält.

  Zeige, dass $\sum_n{\dfrac{1}{a_n}}<29$ gilt. 
\end{quote}
\begin{loesung}
  $b_n$ entsteht aus $a_n$, indem alle Ziffern bis auf die erste durch Nullen
  ersetzt werden.  Dann ist $b_n\le a_n$ und
  \begin{align*}
    \sum_n{\frac{1}{a_n}}\le\sum_n{\frac{1}{b_n}}&<\br{1+\frac12+\dots+\frac19}
    +\br{\frac{9}{10}+\frac{9}{20}+\dots+\frac{9}{90}}\\&\qquad
    +\br{\frac{9^2}{10^2}+\frac{9^2}{2\m 10^2}+\dots+\frac{9^2}{9\m 10^2}}+
    \dots\\ &=
    \br{1+\frac12+\dots+\frac19}\br{1+\frac{9}{10}+\br{\frac{9}{10}}^2+\dots}
    <2{,}83\m 10 <29.
  \end{align*}
  Interessant ist, dass die Summe aller Reziproken der Zahlen $1,2,\dots$ als
  Harmonische Reihe divergiert.
\end{loesung}
\begin{quote}
  Frage: Gibt es mehr Zahlen ohne Nullen oder mit Nullen?
\end{quote}
Unter den (genau) $k$-stelligen Zahlen gibt es $9^k$ Zahlen ohne Nullen.  Für
alle Zahlen $N<10^n$ ist die Anzahl der Zahlen ohne Nullen also
\begin{gather*}
  9+9^2+\dots+9^n=\frac98\br{9^n-1}
\end{gather*}
Für große $n$ gibt es also „fast“ keine Zahlen ohne Nullen. 

\paragraph{(MO 291044)}
\begin{quote}
  Im folgenden $(5\times5)$-Quadrat stehen in allen Zeilen und Spalten
  arithmetische Folgen.  Wie viele Möglichkeiten gibt es, das Quadrat zu
  ergänzen?
  \begin{center}
    \def\abst{\hspace*{1em}}
    \begin{tabular}{*{5}{|c}|}\hline
      \abst&  &  &\abst&65\\\hline
      &41&  &     &\\\hline
      &  &81&     &\\\hline
      &  &  &     &\\\hline
      1&  &  &     &\\\hline
    \end{tabular}
  \end{center}
\end{quote}
\begin{loesung}
\begin{center}
\def\abst{\hspace*{1em}}
  \begin{tabular}{*{5}{|c}|}\hline
    $x$&  &$y$&\abst&65\\\hline
    $z$&41&$w$&     &\\\hline
       &  &81 &     &\\\hline
       &  &   &     &\\\hline
      1&  &   &     &\\\hline
  \end{tabular}\hskip5em
  \begin{tabular}{*{5}{|c}|}\hline
     25&35& 45& 55& 65\\\hline
     19&41& 63& 85&107\\\hline
     13&47& 81&115&149\\\hline
      7&53& 99&145&191\\\hline
      1&59&117&175&233\\\hline
  \end{tabular}
\end{center}
Für die Werte der vier Variablen $x,y,z,w$ muss gelten $65-y=y-x$,
$w-41=41-z$, $1-z=3(z-x)$, $81-w=w-y$. Löse das Gleichungssystem: $z=82-w$,
$y=2w-81$, $x=2y-65=4w-227$, $1=4z-3x=4\m82-5w-16w+3\m227$, $16w=1008$. Daraus
ergibt sich $w=63$, $x=25$, $y=45$, $z=19$ und der Rest lässt sich einfach
ergänzen. 
\end{loesung}

Wir haben hier verwendet, dass für jede arithmetische Folge
$a_{n+2}-a_{n+1}=a_{n+1}-a_n$, also $a_{n+2}=2a_{n+1}-a_n$ gilt.

\section*{Homogene lineare rekursive Folgen mit konstanten Koeffizienten}

Als \emph{homogene lineare rekursive Folge mit konstanten Koeffizienten} (HLR) 
bezeichnet man jede Folge dieser Bauart:
\begin{gather*}
  a_{n+k}=c_1a_{n+k-1}+c_2a_{n+k-2}+\dots+c_ka_n\ \text{für}\ n\in\N.
\end{gather*}
Die ersten $k$ Folgenglieder können beliebig vorgegeben werden, die restlichen
ergeben sich daraus eindeutig nach der Bildungsvorschrift.

Weiter wie in \cite{S}, Abschnitte 1 und 2. Verwandle dabei explizite
Bildungsvorschriften in HLR.  

Beispiele 1-4 aus \cite{S}, u.a. die \emph{Fibonacci-Folge}
\begin{gather*}
  a_1=a_2=1,\ a_{n+2}=a_{n+1}+a_n\ \text{für}\ n>0.
\end{gather*}

Zu Beispiel 4 Polynomdivision an einem Beispiel vorführen $1:(1-2x)$. Dann das
Beispiel in Axels Skript.

Beispiel 5 auslassen.

Dann zunächst das folgende Beispiel:

\paragraph{(MO 281224)}
\begin{quote}
  Es ist $x_1=y_1=2022$ sowie $x_{n+1}=2x_n-1$, $y_{n+1}=2y_n-2^{n+1}$ für
  $n>0$.  Untersuche für beide Folgen, ob alle Folgenglieder positiv sind.
\end{quote}
\begin{loesung}
  Erste Folge kann mit $z_n=x_n-1$ auf Potenzfolge $z_{n+1}=2z_n$
  zurückgeführt werden. Es ist $z_n=2^{n-1}z_1$ und damit
  $x_n=2^{n-1}\br{x_1-1}+1$ immer positiv.  Wir hätten auch die ersten Glieder
  mit \cas{Maxima} mit einem variablen Startwert $a$ berechnen können
  \begin{code}
    x(n):=if n=1 then a\\
    else expand(2*x(n-1)-1);
  \end{code}
  \begin{gather*}
    x_1=a, x_2=2a-1, x_3=4a-3, x_4=8a-7, \dots
  \end{gather*}
  und dann die Formel $x_n=2^{n-1}2022-2^{n-1}+1$ vermuten und diese mit
  vollständiger Induktion beweisen können. 

  Die zweite Folge scheint ebenfalls schnell zu wachsen, wenn wir die ersten
  Folgenglieder berechnen.  Berechnen wir wieder die ersten Glieder mit
  \cas{Maxima} mit einem variablen Startwert~$a$ 
  \begin{code}
    x(n):=if n=1 then a\\
    else expand(2*x(n-1)-2\pw n);
  \end{code}
  \begin{gather*}
    y_1=a, y_2=2a-4, y_3=4a-16, y_4=8a-48, y_5=16a-128,\dots
  \end{gather*}
  so vermuten wir $y_n=2^{n-1}\br{a-2n+2}=(1012-n)\m 2^n$.   Wir können wieder
  mit Induktion prüfen, dass die Formel korrekt ist:
  \begin{gather*}
    y_{n+1}=2y_n-2^{n+1}=(1012-n)\m2^{n+1}-2^{n+1}=(1012-(n+1))\m2^{n+1}.
  \end{gather*}
\end{loesung}
Für $n>1012$ ist also $y_n$ negativ.

Dann die Lösung der allgemeinen HLR.

Dann zurück zur Aufgabe oben. 

Dann Beispiel 6, die Binetsche Formel für die Fibonacci-Folge.

Weiter mit Aufgaben aus \cite{S}.

\paragraph{\cite{S}, Aufgabe 1}

\paragraph{\cite{S}, Aufgabe 2:}
Zunächst Zahlenwerte bestimmen.
\begin{code}
  a(n):=if n=1 then 1\\
  else (1/16*(1+4*a(n-1)+sqrt(1+24*a(n-1)))); 
\end{code}
Sind alles rationale Zahlen.  $b_n=\sqrt{1+24a_n}$, also $b_1=5, b_2=4$ und
$a_n=\br{b_n^2-1}{24}$. Usw. wie in \cite{S}.

$b_{n+1}=\frac12b_n+\frac32$ ist keine HLR.  Man errät vielleicht
$b_n=A\m2^{-n}+B$ und bekommt aus den Startwerten $A=4, B=3$.  Man kann die
Rekursion aber auch wie oben in eine HLR verwandeln:
\begin{gather*}
  b_{n+2}-\frac12 b_{n+1}=b_{n+1}-\frac12 b_n,\\
  b_{n+2}=\frac32 b_{n+1}-\frac12 b_n,\\
  p(x)=x^2-\frac32 x-\frac12=(x-1)\br{x-\frac12},
\end{gather*}
was auf denselben Ansatz führt. 

\paragraph{\cite{S}, Aufgabe 9:}
Symbolische Berechnung der ersten Werte der Folge
\begin{gather*}
  b_n=a_n^2+4\br{a_0^2+a_1^2-3a_0a_1}
\end{gather*}
ergibt $b_n=c_n^2$ mit einer Folge $c_0=3a_0-2a_1$, $c_1=2a_0-3a_1=3a_1-2a_2$
und $c_{n+2}=3c_{n+1}-c_n$.  Das legt die Vermutung $c_n=3a_n-2a_{n+1}$ nahe.
Es bleibt zu zeigen, dass dies allgemein gilt.  Beweis mit Induktion und
$a_n=3a_{n+1}-a_{n+2}$, wobei der Induktionsanfang schon gezeigt wurde.
\begin{align*}
  b_{n+1}&=b_n+5a_{n+1}^2-5a_n^2=\br{3a_n-2a_{n+1}}^2+5a_{n+1}^2-5a_n^2\\
  &=\br{7a_{n+1}-3a_{n+2}}^2+5a_{n+1}^2-5\br{3a_{n+1}-a_{n+2}}^2\\
  &=9a_{n+1}^2-12a_{n+1}a_{n+2}+4a_{n+2}^2=\br{3a_{n+1}-2a_{n+2}}^2=c_{n+1}^2.
\end{align*}

\paragraph{\cite{S}, Aufgabe 10:}
Es ist $a_3=2$ und die Rekursionsbeziehung lautet für $n$ und $n+1$ 
\begin{gather*}
  a_na_{n-2}=a_{n-1}^2+1,\ a_{n+1}a_{n-1}=a_n^2+1.
\end{gather*}
Die Differenz ergibt $a_n\br{a_n+a_{n-2}}=a_{n-1}\br{a_{n+1}+a_{n-1}}$ und
weiter 
\begin{gather*}
  c_n=\frac{a_n+a_{n-2}}{a_{n-1}}=\frac{a_{n+1}+a_{n-1}}{a_n}=c_{n+1}.
\end{gather*}
Die Folge $(c_n)$ ist also konstant mit $c_n=3$ und $(a_n)$ genügt der
Rekursionsbeziehung $a_{n+2}=3a_{n+1}-a_n$.  Damit ist die Ganzzahligkeit der
Folgenglieder bereits gezeigt. 

Wir berechnen noch die explizite Darstellung.  Das charakteristische Polynom
$x^2-3x+1$ hat die beiden Nullstellen $q_1=\dfrac{3+\sqrt{5}}{2}$ und
$q_2=\dfrac{3-\sqrt{5}}{2}=q_1^{-1}$.  Es gilt also $a_n=Aq_1^n+Bq_2^n$ für
geeignete $A,B$.  Da die Folge auch für $n\le 0$ fortgesetzt werden kann und
sich dort $a_0=2$ ergibt, bestimmen sich $A$ und $B$ aus $A+B=2$ und
$Aq_1+Bq_2=1$ zu $A=1-\dfrac{2}{\sqrt{5}}$ und $B=1+\dfrac{2}{\sqrt{5}}$,
womit wir insgesamt die explizite Formel
\begin{gather*}
  a_n=\br{1-\frac{2}{\sqrt{5}}}\br{\frac{3+\sqrt{5}}{2}}^n
  +\br{1+\frac{2}{\sqrt{5}}}\br{\frac{3-\sqrt{5}}{2}}^n 
\end{gather*}
erhalten.  Eine Vergleichsrechnung mit CAS zeigt, dass die Formel für endliche
Mengen von Werten korrekt ist.

\paragraph{\cite{S}, Aufgabe 4:}
Diese Aufgabe verallgemeinert Aufgabe 10, die sich für $A=B=C=1$ ergibt. 

Wir setzen $D=\dfrac{A^2+B^2+C}{AB}$. Damit ist 
\begin{gather*}
  C=ABD-A^2-B^2\ \text{und}\ a_3=\frac{b^2+C}{A}=\frac{ABD-A^2}{A}=BD-A.
\end{gather*}
Aus der Rekursionsbeziehung für $n$ und $n+1$ erhalten wir
\begin{gather*}
  a_na_{n-2}=a_{n-1}^2+C,\ a_{n+1}a_{n-1}=a_n^2+C.
\end{gather*}
Die Differenz ergibt $a_n\br{a_n+a_{n-2}}=a_{n-1}\br{a_{n+1}+a_{n-1}}$ und
weiter 
\begin{gather*}
  c_n=\frac{a_n+a_{n-2}}{a_{n-1}}=\frac{a_{n+1}+a_{n-1}}{a_n}=c_{n+1}.
\end{gather*}
Die Folge $\br{c_n}$ ist also konstant und wir erhalten
$c_n=c_3=\dfrac{a_3+a_1}{a_2}=\dfrac{BD-A+A}{B}=D$.  $\br{a_n}$ genügt also
der Rekursion $a_{n+2}=Da_{n+1}-a_n$.

\paragraph{(MO 261242)}
\begin{quote}
  Ermittle alle Zahlenfolgen mit $a_1=1$, $a_2=\frac52$, für die
  \begin{gather*}
    a_{m+n}\m a_{m-n}=a_m^2-a_n^2\ \text{für alle}\ m>n>0
  \end{gather*}
  gilt.
\end{quote}
\begin{loesung}
  Für $n=1$ ergibt sich $a_{m+1}=\dfrac{a_m^2-1}{a_{m-1}}$, womit die
  Zahlenfolge zumindest eindeutig bestimmt ist, wenn sie existiert.

  Die Rekursionsbeziehung ist von ähnlicher Bauart wie die von Aufgaben 10,
  wobeidie dortige Ableitung der linearen Rekursion nicht daran gebunden ist,
  dass $A,B,C$ ganzzahlig sein müssen.  Hier ist $A=1, B=\frac52, C=-1$ und
  damit $D=\dfrac{A^2+B^2+C}{AB}=\frac52$.  Die Folge $a_n$ erfüllt also die
  Rekursion $a_{n+2}=\frac52a_{n+1}-a_n$.  Das charakteristische Polynom ist
  $p(x)=x^2-\frac52x+1$ mit den Nullstellen $q_1=2, q_2=\frac12$.  Die
  explizite Bildungsvorschrift ergibt sich aus dem Ansatz $a_n=Aq_1^n+Bq_2^n$,
  für den man aus den Startwerten $A=\frac23, B=-\frac23$ ermittelt.

  Die Gültigkeit der Beziehung
  \begin{gather*}
    a_{m+n}\m a_{m-n}=a_m^2-a_n^2\ \text{für alle}\ m>n>0
  \end{gather*}
  rechnet man nun leicht nach.
\end{loesung}

\paragraph{\cite{S}, Aufgabe 11:}
Diese Aufgabe ist ähnlich zur Aufgabe 2.2 im BWM 2003. 
\begin{quote}
  Zeigen Sie, dass alls Glieder der durch 
  \begin{gather*}
    a_1=1, a_2=1, a_3=2\ \text{sowie}\ a_{n+3}=\frac{a_{n+2}a_{n+1}+7}{a_n}\
    \text{für}\ n>0 
  \end{gather*}
  gegebenen Folge ganzzahlig sind.  
\end{quote}
Berechnet man numerisch die Quotienten aufeinanderfolgender Glieder eines
Anfangsstücks der Folge, so ergeben sich näherungsweise alternierend zwei
Werte, was die Vermutung nahe legt, dass -- wie in der dritten Lösung der
BWM-Aufgabe -- auch die Folge in Aufgabe 11 über zwei verschränkte
Rekursionsbeziehungen für gerade und ungerade Indizes berechnet werden kann.
Dies ist in der Tat so. Wir bilden wieder die Differenz der
Rekursionsbeziehung für $n$ und $n+1$:
\begin{gather*}
  a_na_{n-3}=a_{n-1}a_{n-2}+1,\ a_{n+1}a_{n-2}=a_na_{n-1}+1,\\
  a_n\br{a_{n-1}+a_{n-3}}=a_{n-2}\br{a_{n+1}+a_{n-1}},\\
  c_{n+1}=\frac{a_{n+1}+a_{n-1}}{a_n}=\frac{a_{n-1}+a_{n-3}}{a_{n-2}}=c_{n-2}.
\end{gather*}
Im Gegensatz zur Aufgabe 4 und 10 ist hier also
\begin{gather*}
  c_3=c_5=\dots=\frac{a_3+a_1}{a_2}=2\ \text{und}\
  c_4=c_6=\dots=\frac{a_4+a_2}{a_3}=3, 
\end{gather*}
was die Rekursionen
\begin{gather*}
  a_{2n}=3a_{2n-1}-a_{2n-2}\ \text{und}\ a_{2n+1}=2a_{2n}-a_{2n-1}
\end{gather*}
liefert.  Daraus folgt zunächst die Ganzzahligkeit der Folgenglieder.  In der
ersten Lösung der BWM-Aufgabe wird eine einfache Rekursion der Tiefe 4
angegeben, der die Folge ebenfalls genügt.  Das soll nun für die hier gegebene
Folge ebenfalls hergeleitet werden.  Es gilt
\begin{align*}
  a_{2n+2}&=3a_{2n+1}-a_{2n}, a_{2n}=3a_{2n-1}-a_{2n-2}\\
  a_{2n+2}&=3\br{a_{2n+1}+a_{2n-1}=2a_{2n}}-2a_{2n}-a_{2n-2}=4a_{2n}-a_{2n-2} 
\end{align*}
und ähnlich
\begin{align*}
  a_{2n+1}&=2a_{2n}-a_{2n-1}, a_{2n-1}=3a_{2n-2}-a_{2n-3}\\
  a_{2n+1}&=2\br{a_{2n}+a_{2n-2}=3a_{2n-1}}-2a_{2n-1}-a_{2n-3}=4a_{2n-1}-a_{2n-3}.
\end{align*}
Die Folge genügt also der gemeinsamen Rekursion $a_{n+4}=4a_{n+2}-a_n$.
Daraus ergibt sich als explizite Formel der Ansatz 
\begin{gather*}
  a_n=Aq_1^n+B\br{-q_1}^n+Cq_2^n+D\br{-q_2}^n
\end{gather*}
mit $q_1=\sqrt{2+\sqrt{3}}$ und $q_2=\sqrt{2-\sqrt{3}}=q_1^{-1}$, da das
charakteristische Polynom $p(x)=x^4-4x^2+1$ die vier Nullstellen $\pm q1, \pm
q_2$ hat. 

\paragraph{\cite{S}, Aufgabe 12:}
Folge $x_n$ hat $p(x)=x^2-2x-1=(x-2)(x+1)$ als char. Polynom und damit
$x_n=A\m2^n+B\m(-1)^n$.  Einsetzen der Startwerte liefert $A=\frac13,
B=-\frac13$ und somit $x_n=\frac13\br{2^n-(-1)^n}$.

Folge $y_n$ hat $p(x)=x^2-3x-1=(x-3)(x+1)$ und damit $y_n=A\m3^n+B\m(-1)^n$.
Einsetzen der Startwerte liefert $A=\frac23, B=1$ und somit
$y_n=3^{n-1}+(-1)^n$.

\paragraph{\cite{S}, Aufgabe 13:}
Für $f(x)=c_nx^n+\dots+c_1x+c_0$ ist $c_0=1$ und $c_n+c_{n-1}+\dots+c_1=0$.
Damit ist
\begin{align*}
  a_{k+1}&=f(a_k)=a_k\br{c_na_k^{n-1}+\dots+c_1}+1\\
  &=a_k\br{c_n\br{a_k^{n-1}-1}+\dots+c_1(1-1)}+1\\
  &=a_k\br{a_k-1}\m p_k+1
\end{align*}
und zunächst $\gcd\br{a_{k+1},a_k}=1$.  Mit Induktion zeigt man
$a_k-1=a_{k-1}\m\dots\m a_1\m q_k$.  In der Tat, setzt man das oben ein, so
ergibt sich 
\begin{gather*}
  a_{k+1}-1=a_k\br{a_k-1}\m p_k=a_k\m a_{k-1}\m\dots\m a_1\m q_k\m p_k
\end{gather*}
und so $q_{k+1}=q_k\m p_k$.  Damit sind die $a_k$ aber paarweise
teilerfremd. 

\paragraph{\cite{S}, Aufgabe 17:}
Probiert man die ersten Werte aus, so zeigt sich, dass sich eine Folge von
Quotienten von Fibonacci-Zahlen ergibt.
\begin{code}
  x(n):=if n=1 then 1\\
  else 1/(1+x(n-1));
\end{code}
Auch daraus folgt die Aussage $x_{2n}<q, x_{2n+1}>q$. 

\paragraph{\cite{S}, Aufgabe 18}

\begin{thebibliography}{Wor77}

\bibitem[S]{S} A.~Schüler.  \newblock \emph{Rekursive Folgen}.  Text
  \emph{schueler-05-1} im KoSemNet.

\bibitem[Mar77]{b-Markuschewitsch} A.~I. Markuschewitsch.  \newblock
  \emph{{R}ekursive {F}olgen}.  \newblock Number~xi in Kleine
  Erg{\"a}nzungsreihe zu den Hochschulb{\"u}chern f{\"u}r Mathematik. VEB
  Deutscher Verlag der Wissenschaften, Berlin, 4 edition, 1977.

\bibitem[Wor77]{b-Worobjow} N.~N. Worobjow.  \newblock \emph{Die Fibonaccischen
  Zahlen}.  \newblock Number~1 in Kleine Erg{\"a}nzungsreihe zu den
  Hochschulb{\"u}chern f{\"u}r Mathematik. VEB Deutscher Verlag der
  Wissenschaften, Berlin, 1977.

\end{thebibliography}


\end{document}

f(n):=if n=0 then 0
else if n=1 then 1
else f(n-1)+f(n-2);

f(n):=if n=0 then A[0]:0
else if n=1 then A[1]:1
else if numberp(A[n]) then A[n]
else A[n]:f(n-1)+f(n-2);

Problem des rekursiven Aufrufs, deutlich sichtbar ab n=25

% MO 261242

a(n):=if n=1 then 1
else if n=2 then 5/2
else (a(n-1)^2-1)/a(n-2);

b(n):=if n=1 then 1
else if n=2 then 5/2
else 5/2*b(n-1)-b(n-2);

% MO 281224

y(n):=if n=1 then 2023 else 2*y(n-1)-2^(n+1);

% MO 271245

x(n):=if n=0 then 1
else if n=1 then 1
else (x(n-1)+1)/(x(n-2)+4);

x(n):=if n=0 then A[n]:1
else if n=1 then A[n]:1
else if numberp(A[n]) then A[n]
else A[n]:(x(n-1)+1)/(x(n-2)+4);

y(n):=x(n)-1/2*(sqrt(13)-3);

x(n):=if n=0 then 1
else 1/2*(x(n-1)+2/x(n-1));

Aufgabe 2:

a(n):=if n=1 then 1
else (1/16*(1+4*a(n-1)+sqrt(1+24*a(n-1)))); 

Aufgabe 10:

a(n):=if n=1 then 1
else if n=2 then 1
else (a(n-1)^2+1)/a(n-2);

b(n):=(1-2/sqrt(5))*((3+sqrt(5))/2)^n+(1+2/sqrt(5))*((3-sqrt(5))/2)^n;

Aufgabe 11:

a(n):=if n=1 then 1
else if n=2 then 1
else if n=3 then 1
else (a(n-1)*a(n-2)+1)/a(n-3);

c(n):=if n=1 then 1
else if n=2 then 1
else if evenp(n) then 3*c(n-1)-c(n-2)
else 2*c(n-1)-c(n-2);

b(n):=if n=1 then 1
else if n=2 then 1
else if n=3 then 1
else if n=4 then 2
else 4*b(n-2)-b(n-4);

BWM 2003-2.2

a(n):=if n=1 then 1
else if n=2 then 1
else if n=3 then 2
else (a(n-1)*a(n-2)+7)/a(n-3);

e(n):=if n=1 then 1
else if n=2 then 1
else if evenp(n) then 5*e(n-1)-e(n-2)
else 3*e(n-1)-e(n-2);

b(n):=if n=1 then 1
else if n=2 then 1
else if n=3 then 2
else if n=4 then 9
else 13*b(n-2)-b(n-4);

----------------------------------

x(n):=if n=1 then a
else expand(x(n-1)^2-x(n-1)+1);

x(n):=if n=1 then 1 else 1/(1+x(n-1));

a(n):=if n=0 then a0
else if n=1 then a1
else expand(3*a(n-1)-a(n-2));

c(n):=if n=0 then (2*a1-3*a0)
else if n=1 then (3*a1-2*a0)
else expand(3*c(n-1)-c(n-2));

b(n):=5*a(n)^2+4*(a0^2+a1^2-3*a0*a1);


a(n):=if n=0 then 2
else if n=1 then 4
else 4*a(n-1)-a(n-2);

x(n):=if n=0 then 2
else if n=1 then x
else expand(x*x(n-1)-x(n-2));

x(n):=if n=1 then a
else expand(2*x(n-1)-2^n);

x(n):=if n=1 then 1
else 1/(1+x(n-1));

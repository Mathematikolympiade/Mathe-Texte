\documentclass[11pt,a4paper]{article}
\usepackage{ngerman,schueler,url}
\usepackage{kosemnet,ko-math}

\title{Rekursive Folgen} 
\author{Hans-Gert Gräbe\\[8pt]
\url{mailto:graebe@informatik.uni-leipzig.de}}
\date{13. Oktober 2023}

\begin{document}
\maketitle

Dieser Text setzt auf \cite{S} auf. Es werden u.a. einige der dort ohne Lösung
angegebenen Aufgaben besprochen. 

\section*{Rekursiv gegebene konvergente Folgen}

\paragraph{(MO 271245)}
Gegeben ist die Folge mit $x_1=x_2=1$ und $x_{n+1}=\frac{x_n+1}{x_{n-1}+4}$
für $n>1$.  Untersuchen Sie, ob die Folge konvergiert und bestimmen Sie ggf.
den Grenzwert.

\begin{loesung}
  
\end{loesung}


\paragraph{Newtonverfahren zum Berechnen der Quadratwurzel}
\begin{gather*}
  x_0(a)=a, x_n(a)=\frac12\br{x_{n-1}(a)+\frac{a}{x_{n-1}(a)}},\quad n>0
\end{gather*}
Konvergiert gegen $\sqrt{a}$. Schnell konvergierendes Verfahren. 

\section*{Arithmetische und polynomiale Folgen als Differenzenfolgen}

\emph{Lernziele:}
\begin{itemize}
\item Arithmetische Folgen $a_n=c+d\m n$ sind charakterisiert durch
  $a_{n+2}-a_{n+1}=a_{n+1}-a_n$ oder $a_{n+2}=2a_{n+1}+a_n$.
\item Übung im Lösen linearer Gleichungssysteme.
\end{itemize}
\paragraph{(MO 291044)}
Im folgenden $(5\times5)$-Quadrat stehen in allen Zeilen und Spalten
arithmetische Folgen.  Wie viele Möglichkeiten gibt es, das Quadrat zu
ergänzen? 
\begin{center}
\def\abst{\hspace*{1em}}
  \begin{tabular}{*{5}{|c}|}\hline
    \abst&  &  &\abst&65\\\hline
         &41&  &     &\\\hline
         &  &81&     &\\\hline
         &  &  &     &\\\hline
        1&  &  &     &\\\hline
  \end{tabular}
\end{center}

\begin{loesung}
\begin{center}
\def\abst{\hspace*{1em}}
  \begin{tabular}{*{5}{|c}|}\hline
    $x$&  &$y$&\abst&65\\\hline
    $z$&41&$w$&     &\\\hline
       &  &81 &     &\\\hline
       &  &   &     &\\\hline
      1&  &   &     &\\\hline
  \end{tabular}
  \begin{tabular}{*{5}{|c}|}\hline
     25&35& 45& 55& 65\\\hline
     19&41& 63& 85&107\\\hline
     13&47& 81&115&149\\\hline
      7&53& 99&145&191\\\hline
      1&59&117&175&233\\\hline
  \end{tabular}
\end{center}
Für die Werte der vier Variablen $x,y,z,w$ muss gelten $65-y=y-x$,
$w-41=41-z$, $1-z=3(z-x)$, $81-w=w-y$. Löse das Gleichungssystem: $z=82-w$,
$y=2w-81$, $x=2y-65=4w-227$, $1=4z-3x=4\m82-5w-16w+3\m227$, $16w=1008$. Daraus
ergibt sich $w=63$, $x=25$, $y=45$, $z=19$ und der Rest lässt sich einfach
ergänzen. 
\end{loesung}

\section*{Lösungen zu Aufgaben in \cite{S}}

\paragraph{Aufgabe 3:}
Am rechten Rand können ein Dominostein hochkant oder zwei Dominosteine
horizontal liegen.  Damit ergibt sich die Rekursion $a_{n+2}=a_{n+1}+a_n$ mit
$a_1=1, a_2=2$.


\paragraph{Aufgabe 9:}
Symbolische Berechnung der ersten Werte der Folge
$b_n=a_n^2+4\br{a_0^2+a_1^2-3a_0a_1}$ ergibt $b_n=c_n^2$ mit einer Folge
$c_0=3a_0-2a_1$, $c_1=2a_0-3a_1=3a_1-2a_2$ und $c_{n+2}=3c_{n+1}-c_n$.  Das
legt die Vermutung $c_n=3a_n-2a_{n+1}$ nahe. Es bleibt zu zeigen, dass dies
allgemein gilt.  Beweis mit Induktion und $a_n=3a_{n+1}-a_{n+2}$, wobei der
Induktionsanfang schon gezeigt wurde.
\begin{align*}
  b_{n+1}&=b_n+5a_{n+1}^2-5a_n^2=\br{3a_n-2a_{n+1}}^2+5a_{n+1}^2-5a_n^2\\
  &=\br{7a_{n+1}-3a_{n+2}}^2+5a_{n+1}^2-5\br{3a_{n+1}-a_{n+2}}^2\\
  &=9a_{n+1}^2-12a_{n+1}a_{n+2}+4a_{n+2}^2=\br{3a_{n+1}-2a_{n+2}}^2=c_{n+1}^2.
\end{align*}

\section*{Eine spezielle Aufgabengruppe}

\paragraph{Aufgabe 10:}
Es ist $a_3=2$ und die Rekursionsbeziehung lautet für $n$ und $n+1$ 
\begin{gather*}
  a_na_{n-2}=a_{n-1}^2+1,\ a_{n+1}a_{n-1}=a_n^2+1.
\end{gather*}
Die Differenz ergibt $a_n\br{a_n+a_{n-2}}=a_{n-1}\br{a_{n+1}+a_{n-1}}$ und
weiter 
\begin{gather*}
  c_n=\frac{a_n+a_{n-2}}{a_{n-1}}=\frac{a_{n+1}+a_{n-1}}{a_n}=c_{n+1}.
\end{gather*}
Die Folge $(c_n)$ ist also konstant mit $c_n=3$ und $(a_n)$ genügt der
Rekursionsbeziehung $a_{n+2}=3a_{n+1}-a_n$.

Das charakteristische Polynom $x^2-3x+1$ hat die beiden Nullstellen
$q_1=\frac{3+\sqrt{5}}{2}$ und $q_2=\frac{3-\sqrt{5}}{2}=q_1^{-1}$.  Es gilt
also $a_n=Aq_1^n+Bq_2^n$ für geeignete $A,B$.  Da die Folge auch für $n\le 0$
fortgesetzt werden kann und sich dort $a_0=2$ ergibt, bestimmen sich $A$ und
$B$ aus $A+B=2$ und $Aq_1+Bq_2=1$ zu $A=1-\frac{2}{\sqrt{5}}$ und
$B=1+\frac{2}{\sqrt{5}}$, womit wir insgesamt die explizite Formel
\begin{gather*}
  a_n=\br{1-\frac{2}{\sqrt{5}}}\br{\frac{3+\sqrt{5}}{2}}^n
  +\br{1+\frac{2}{\sqrt{5}}}\br{\frac{3-\sqrt{5}}{2}}^n 
\end{gather*}
erhalten.  Eine Vergleichsrechnung mit CAS zeigt, dass die Formel für endliche
Mwngen von Werten korrekt ist.

\paragraph{Aufgabe 4:}
Diese Aufgabe verallgemeinert Aufgabe 10, die sich für $A=B=C=1$ ergibt. 

Wir setzen $D=\frac{A^2+B^2+C}{AB}$. Damit ist 
\begin{gather*}
  C=ABD-A^2-B^2\ \text{und}\ a_3=\frac{b^2+C}{A}=\frac{ABD-A^2}{A}=BD-A.
\end{gather*}
Aus der Rekursionsbeziehung für $n$ und $n+1$ erhalten wir
\begin{gather*}
  a_na_{n-2}=a_{n-1}^2+C,\ a_{n+1}a_{n-1}=a_n^2+C.
\end{gather*}
Die Differenz ergibt $a_n\br{a_n+a_{n-2}}=a_{n-1}\br{a_{n+1}+a_{n-1}}$ und
weiter 
\begin{gather*}
  c_n=\frac{a_n+a_{n-2}}{a_{n-1}}=\frac{a_{n+1}+a_{n-1}}{a_n}=c_{n+1}.
\end{gather*}
Die Folge $\br{c_n}$ ist also konstant und wir erhalten
$c_n=c_3=\frac{a_3+a_1}{a_2}=\frac{BD-A+A}{B}=D$.  $\br{a_n}$ genügt also der
Rekursion $a_{n+2}=Da_{n+1}-a_n$.

\paragraph{(MO 261242)}
Ermittle alle Zahlenfolgen mit $a_1=1$, $a_2=\frac52$, für die
\begin{gather*}
  a_{m+n}\m a_{m-n}=a_m^2-a_n^2\ \text{für alle}\ m>n>0
\end{gather*}
gilt.

\begin{loesung}
  Für $n=1$ ergibt sich $a_{m+1}=\frac{a_m^2-1}{a_{m-1}}$, womit die
  Zahlenfolge zumindest eindeutig bestimmt ist, wenn sie existiert.

  Die Rekursionsbeziehung ist von ähnlicher Bauart wie die von Aufgaben 10,
  wobeidie dortige Ableitung der linearen Rekursion nicht daran gebunden ist,
  dass $A,B,C$ ganzzahlig sein müssen.  Hier ist $A=1, B=\frac52, C=-1$ und
  damit $D=\frac{A^2+B^2+C}{AB}=\frac52$.  Die Folge $a_n$ erfüllt also die
  Rekursion $a_{n+2}=\frac52a_{n+1}-a_n$.  Das charakteristische Polynom ist
  $p(x)=x^2-\frac52x+1$ mit den Nullstellen $q_1=2, q_2=\frac12$.  Die
  explizite Bildungsvorschrift ergibt sich aus dem Ansatz $a_n=Aq_1^n+Bq_2^n$,
  für den man aus den Startwerten $A=\frac23, B=-\frac23$ ermittelt.

  Die Gültigkeit der Beziehung
  \begin{gather*}
    a_{m+n}\m a_{m-n}=a_m^2-a_n^2\ \text{für alle}\ m>n>0
  \end{gather*}
  rechnet man nun leicht nach.
\end{loesung}

\paragraph{Aufgabe 11:}
Diese Aufgabe ist ähnlich zur Aufgabe 2.2 im BWM 2003. 
\begin{quote}
  Zeigen Sie, dass alls Glieder der durch $a_1=1, a_2=1, a_3=2$ sowie
  $a_{n+3}=\frac{a_{n+2}a_{n+1}+7}{a_n}$ gegebenen Folge ganzzahlig sind.  
\end{quote}
Berechnet man numerisch die Quotienten aufeinanderfolgender Glieder eines
Anfangsstücks der Folge, so ergeben sich näherungsweise alternierend zwei
Werte, was die Vermutung nahe legt, dass -- wie in der dritten Lösung der
BWM-Aufgabe -- auch die Folge in Aufgabe 11 über zwei verschränkte
Rekursionsbeziehungen für gerade und ungerade Indizes berechnet werden kann.
Dies ist in der Tat so. Wir bilden wieder die Differenz der
Rekursionsbeziehung für $n$ und $n+1$:
\begin{gather*}
  a_na_{n-3}=a_{n-1}a_{n-2}+1,\ a_{n+1}a_{n-2}=a_na_{n-1}+1,\\
  a_n\br{a_{n-1}+a_{n-3}}=a_{n-2}\br{a_{n+1}+a_{n-1}},\\
  c_{n+1}=\frac{a_{n+1}+a_{n-1}}{a_n}=\frac{a_{n-1}+a_{n-3}}{a_{n-2}}=c_{n-2}.
\end{gather*}
Im Gegensatz zur Aufgabe 4 und 10 ist hier also
$c_3=c_5=\dots=\frac{a_3+a_1}{a_2}=2$ und
$c_4=c_6=\dots=\frac{a_4+a_2}{a_3}=3$, was die Rekursionen
\begin{gather*}
  a_{2n}=3a_{2n-1}-a_{2n-2}\ \text{und}\ a_{2n+1}=2a_{2n}-a_{2n-1}
\end{gather*}
liefert.  Daraus folgt zunächst die Ganzzahligkeit der Folgenglieder.  In der
ersten Lösung der BWM-Aufgabe wird eine einfache Rekursion der Tiefe 4
angegeben, der die Folge ebenfalls genügt.  Das soll nun für die hier gegebene
Folge ebenfalls hergeleitet werden.  Es gilt
\begin{align*}
  a_{2n+2}&=3a_{2n+1}-a_{2n}, a_{2n}=3a_{2n-1}-a_{2n-2}\\
  a_{2n+2}&=3\br{a_{2n+1}+a_{2n-1}=2a_{2n}}-2a_{2n}-a_{2n-2}=4a_{2n}-a_{2n-2} 
\end{align*}
und ähnlich
\begin{align*}
  a_{2n+1}&=2a_{2n}-a_{2n-1}, a_{2n-1}=3a_{2n-2}-a_{2n-3}\\
  a_{2n+1}&=2\br{a_{2n}+a_{2n-2}=3a_{2n-1}}-2a_{2n-1}-a_{2n-3}=4a_{2n-1}-a_{2n-3}.
\end{align*}
Die Folge genügt also der gemeinsamen Rekursion $a_{n+4}=4a_{n+2}-a_n$.
Daraus ergibt sich als explizite Formel der Ansatz 
\begin{gather*}
  a_n=Aq_1^n+B\br{-q_1}^n+Cq_2^n+D\br{-q_2}^n
\end{gather*}
mit $q_1=\sqrt{2+\sqrt{3}}$ und $q_2=\sqrt{2-\sqrt{3}}=q_1^{-1}$, da das
charakteristische Polynom $p(x)=x^4-4x^2+1$ die vier Nullstellen $\pm q1, \pm
q_2$ hat. 



\begin{thebibliography}{Wor77}

\bibitem[S]{S} A.~Schüler.  \newblock \emph{Rekursive Folgen}.  Text
  \emph{schueler-05-1} im KoSemNet.

\bibitem[Mar77]{b-Markuschewitsch} A.~I. Markuschewitsch.  \newblock
  \emph{{R}ekursive {F}olgen}.  \newblock Number~xi in Kleine
  Erg{\"a}nzungsreihe zu den Hochschulb{\"u}chern f{\"u}r Mathematik. VEB
  Deutscher Verlag der Wissenschaften, Berlin, 4 edition, 1977.

\bibitem[Wor77]{b-Worobjow} N.~N. Worobjow.  \newblock \emph{Die Fibonaccischen
  Zahlen}.  \newblock Number~1 in Kleine Erg{\"a}nzungsreihe zu den
  Hochschulb{\"u}chern f{\"u}r Mathematik. VEB Deutscher Verlag der
  Wissenschaften, Berlin, 1977.

\end{thebibliography}


\end{document}

% MO 261242

a(n):=if n=1 then 1
else if n=2 then 5/2
else (a(n-1)^2-1)/a(n-2);

b(n):=if n=1 then 1
else if n=2 then 5/2
else 5/2*b(n-1)-b(n-2);




% MO 271245

x(n):=if n=0 then 1
else if n=1 then 1
else (x(n-1)+1)/(x(n-2)+4);

y(n):=x(n)-1/2*(sqrt(13)-3);

x(n,a):=if n=0 then 1
else 1/2*(x(n-1,a)+a/x(n-1,a));

Aufgabe 10:

a(n):=if n=1 then 1
else if n=2 then 1
else (a(n-1)^2+1)/a(n-2);

b(n):=(1-2/sqrt(5))*((3+sqrt(5))/2)^n+(1+2/sqrt(5))*((3-sqrt(5))/2)^n;

Aufgabe 11:

a(n):=if n=1 then 1
else if n=2 then 1
else if n=3 then 1
else (a(n-1)*a(n-2)+1)/a(n-3);

c(n):=if n=1 then 1
else if n=2 then 1
else if evenp(n) then 3*c(n-1)-c(n-2)
else 2*c(n-1)-c(n-2);

b(n):=if n=1 then 1
else if n=2 then 1
else if n=3 then 1
else if n=4 then 2
else 4*b(n-2)-b(n-4);

BWM 2003-2.2

a(n):=if n=1 then 1
else if n=2 then 1
else if n=3 then 2
else (a(n-1)*a(n-2)+7)/a(n-3);

e(n):=if n=1 then 1
else if n=2 then 1
else if evenp(n) then 5*e(n-1)-e(n-2)
else 3*e(n-1)-e(n-2);

b(n):=if n=1 then 1
else if n=2 then 1
else if n=3 then 2
else if n=4 then 9
else 13*b(n-2)-b(n-4);

----------------------------------

x(n):=if n=1 then a
else expand(x(n-1)^2-x(n-1)+1);

x(n):=if n=1 then 1 else 1/(1+x(n-1));

a(n):=if n=0 then a0
else if n=1 then a1
else expand(3*a(n-1)-a(n-2));

c(n):=if n=0 then (2*a1-3*a0)
else if n=1 then (3*a1-2*a0)
else expand(3*c(n-1)-c(n-2));

b(n):=5*a(n)^2+4*(a0^2+a1^2-3*a0*a1);


